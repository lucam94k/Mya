<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MyA PRO</title>

<style>
:root{
  --green:#1FA64A;
  --blue:#2F7CC2;
  --line:#E6EAF0;
  --shadow:0 10px 25px rgba(0,0,0,.08);
  --radius:18px;
  --font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
}
*{box-sizing:border-box}
body{margin:0;font-family:var(--font);background:#fff}

.top{height:18px;background:var(--green)}
.header{
  height:64px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  font-size:28px;
  color:var(--blue);
  border-bottom:1px solid var(--line);
}

.content{padding:14px 14px 140px}

.btn{
  width:100%;
  height:54px;
  border-radius:14px;
  border:0;
  background:var(--green);
  color:#fff;
  font-size:18px;
  font-weight:900;
  margin-bottom:12px;
}

.card{
  background:#fff;
  border:1px solid var(--line);
  border-radius:var(--radius);
  padding:14px;
  box-shadow:var(--shadow);
  margin-bottom:10px;
}

.addr{font-weight:900}
.sub{font-size:13px;color:#666;margin-top:4px}

.bottom{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  height:80px;
  background:var(--blue);
  display:flex;
  align-items:center;
  justify-content:center;
  color:#fff;
  font-weight:900;
  font-size:20px;
}

.modalWrap{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  display:none;
  align-items:flex-end;
}

.modal{
  background:#fff;
  width:100%;
  border-top-left-radius:26px;
  border-top-right-radius:26px;
  padding:20px;
  max-height:90vh;
  overflow:auto;
}

.titleModal{
  text-align:center;
  font-size:26px;
  font-weight:900;
  color:var(--green);
  margin-bottom:16px;
}

.field{margin-bottom:14px}
.label{font-weight:900;margin-bottom:6px}
.input{
  width:100%;
  border:2px solid #E6EDF5;
  border-radius:14px;
  padding:14px;
  font-size:16px;
}

.select{
  appearance:none;
  width:100%;
  border:2px solid #E6EDF5;
  border-radius:14px;
  padding:14px;
  font-size:16px;
  background:#fff;
}

.createBtn{
  width:100%;
  height:56px;
  border-radius:16px;
  border:0;
  background:var(--green);
  color:#fff;
  font-weight:900;
  font-size:18px;
}

.picker{
  height:200px;
  overflow-y:scroll;
  border-radius:16px;
  border:2px solid #E6EDF5;
}

.picker div{
  padding:12px;
  text-align:center;
  font-weight:900;
  font-size:18px;
}

.picker div:hover{
  background:#F3F6FB;
  cursor:pointer;
}

</style>
</head>

<body>

<div class="top"></div>
<div class="header">Attività PRO</div>

<div class="content">

<button class="btn" onclick="openModal()">+ Nuova Attività</button>

<div id="list"></div>

</div>

<div class="bottom">
Campanelli: <span id="counter">0</span>
</div>

<div class="modalWrap" id="modalWrap">
<div class="modal">
<div class="titleModal">Nuova Attività</div>

<div class="field">
<div class="label">Numero attività</div>
<div class="picker" id="pickerNum"></div>
</div>

<div class="field">
<div class="label">Via</div>
<input class="input" id="via">
</div>

<div class="field">
<div class="label">Civico</div>
<input class="input" id="civico">
</div>

<div class="field">
<div class="label">Esito</div>
<div class="picker" id="pickerEsito"></div>
</div>

<div class="field" id="apptFields" style="display:none">
<div class="label">Data appuntamento</div>
<input class="input" type="date" id="dataApp">
<div class="label">Ora</div>
<input class="input" type="time" id="oraApp">
</div>

<button class="createBtn" onclick="save()">Salva</button>

</div>
</div>

<script>

const STORAGE="mya_pro_v1";
let db=JSON.parse(localStorage.getItem(STORAGE)||'{"activities":[]}');

let activeVia=null;
let selectedNum=1;
let selectedEsito="Assente";

function render(){
  const list=document.getElementById("list");
  list.innerHTML="";
  let count=0;

  db.activities.forEach(a=>{
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`
      <div class="addr">${a.via} ${a.civico}</div>
      <div class="sub">Esito: ${a.esito}</div>
    `;
    list.appendChild(div);
    count+=a.num;
  });

  document.getElementById("counter").textContent=count;
}

function openModal(){
  document.getElementById("modalWrap").style.display="flex";

  if(activeVia){
    document.getElementById("via").value=activeVia;
  }

  buildPickers();
}

function buildPickers(){

  const pickerNum=document.getElementById("pickerNum");
  pickerNum.innerHTML="";
  [1,2,3,4,5,6,7,8,9,10,15,20,30].forEach(n=>{
    const d=document.createElement("div");
    d.textContent=n;
    d.onclick=()=>selectedNum=n;
    pickerNum.appendChild(d);
  });

  const pickerEsito=document.getElementById("pickerEsito");
  pickerEsito.innerHTML="";
  const esiti=[
    "Assente",
    "Ripassare",
    "Appuntamento",
    "Non interessato",
    "App. Dim. Diretta"
  ];

  esiti.forEach(e=>{
    const d=document.createElement("div");
    d.textContent=e;
    d.onclick=()=>{
      selectedEsito=e;
      if(e==="Appuntamento"){
        document.getElementById("apptFields").style.display="block";
      }else{
        document.getElementById("apptFields").style.display="none";
      }
    };
    pickerEsito.appendChild(d);
  });
}

function save(){

  const via=document.getElementById("via").value.trim();
  const civico=document.getElementById("civico").value.trim();

  if(!via || !civico) return;

  activeVia=via;

  db.activities.push({
    via,
    civico,
    num:selectedNum,
    esito:selectedEsito,
    data:document.getElementById("dataApp").value,
    ora:document.getElementById("oraApp").value
  });

  localStorage.setItem(STORAGE,JSON.stringify(db));

  document.getElementById("modalWrap").style.display="none";
  document.getElementById("civico").value="";
  render();
}

render();

</script>

</body>
</html>